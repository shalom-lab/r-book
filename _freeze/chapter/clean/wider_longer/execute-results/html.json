{
  "hash": "80e8bd94b6e93919b9721e8bc26f97db",
  "result": {
    "engine": "knitr",
    "markdown": "## 长宽数据转换\n\n\n\n\n::: {.cell context='setup'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndata_longer<-data.frame(region=LETTERS[1:3],\n                       year=rep(2019:2023,each=3),\n                       case=round(runif(15)*100))\ndata_longer\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"year\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"case\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"A\",\"2\":\"2019\",\"3\":\"66\"},{\"1\":\"B\",\"2\":\"2019\",\"3\":\"100\"},{\"1\":\"C\",\"2\":\"2019\",\"3\":\"80\"},{\"1\":\"A\",\"2\":\"2020\",\"3\":\"75\"},{\"1\":\"B\",\"2\":\"2020\",\"3\":\"67\"},{\"1\":\"C\",\"2\":\"2020\",\"3\":\"83\"},{\"1\":\"A\",\"2\":\"2021\",\"3\":\"41\"},{\"1\":\"B\",\"2\":\"2021\",\"3\":\"14\"},{\"1\":\"C\",\"2\":\"2021\",\"3\":\"67\"},{\"1\":\"A\",\"2\":\"2022\",\"3\":\"10\"},{\"1\":\"B\",\"2\":\"2022\",\"3\":\"8\"},{\"1\":\"C\",\"2\":\"2022\",\"3\":\"52\"},{\"1\":\"A\",\"2\":\"2023\",\"3\":\"24\"},{\"1\":\"B\",\"2\":\"2023\",\"3\":\"86\"},{\"1\":\"C\",\"2\":\"2023\",\"3\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### 长转宽\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_wider1<-data_longer %>%\n  pivot_wider(id_cols = year,names_from = 'region',values_from = 'case' )\ndata_wider1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"A\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"B\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"C\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2019\",\"2\":\"66\",\"3\":\"100\",\"4\":\"80\"},{\"1\":\"2020\",\"2\":\"75\",\"3\":\"67\",\"4\":\"83\"},{\"1\":\"2021\",\"2\":\"41\",\"3\":\"14\",\"4\":\"67\"},{\"1\":\"2022\",\"2\":\"10\",\"3\":\"8\",\"4\":\"52\"},{\"1\":\"2023\",\"2\":\"24\",\"3\":\"86\",\"4\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndata_wider2<-data_longer %>%\n  pivot_wider(id_cols = region,names_from = 'year',names_prefix = 'y_',values_from = 'case' )\ndata_wider2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y_2019\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y_2020\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y_2021\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y_2022\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y_2023\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"A\",\"2\":\"66\",\"3\":\"75\",\"4\":\"41\",\"5\":\"10\",\"6\":\"24\"},{\"1\":\"B\",\"2\":\"100\",\"3\":\"67\",\"4\":\"14\",\"5\":\"8\",\"6\":\"86\"},{\"1\":\"C\",\"2\":\"80\",\"3\":\"83\",\"4\":\"67\",\"5\":\"52\",\"6\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### 宽转长\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_longer2<-data_wider1 %>%\n  pivot_longer(c(A,B,C),names_to = 'region',values_to='count')\ndata_longer2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"region\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"count\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2019\",\"2\":\"A\",\"3\":\"66\"},{\"1\":\"2019\",\"2\":\"B\",\"3\":\"100\"},{\"1\":\"2019\",\"2\":\"C\",\"3\":\"80\"},{\"1\":\"2020\",\"2\":\"A\",\"3\":\"75\"},{\"1\":\"2020\",\"2\":\"B\",\"3\":\"67\"},{\"1\":\"2020\",\"2\":\"C\",\"3\":\"83\"},{\"1\":\"2021\",\"2\":\"A\",\"3\":\"41\"},{\"1\":\"2021\",\"2\":\"B\",\"3\":\"14\"},{\"1\":\"2021\",\"2\":\"C\",\"3\":\"67\"},{\"1\":\"2022\",\"2\":\"A\",\"3\":\"10\"},{\"1\":\"2022\",\"2\":\"B\",\"3\":\"8\"},{\"1\":\"2022\",\"2\":\"C\",\"3\":\"52\"},{\"1\":\"2023\",\"2\":\"A\",\"3\":\"24\"},{\"1\":\"2023\",\"2\":\"B\",\"3\":\"86\"},{\"1\":\"2023\",\"2\":\"C\",\"3\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### 作图多用长数据\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_longer,aes(factor(year),y=case,fill=region))+\n  geom_col(position = 'dodge')+\n  theme_bw()+\n  ggsci::scale_fill_jama()\n```\n\n::: {.cell-output-display}\n![](wider_longer_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "wider_longer_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}