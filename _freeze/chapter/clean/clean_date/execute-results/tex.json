{
  "hash": "aa4250261fbc493b92cbb143d0dfeec7",
  "result": {
    "engine": "knitr",
    "markdown": "# 最佳推荐-lubridate包\n\n该包属于tidyverse组成之一,用于日期和时间处理\n\n\n\n\n\n\n::: {.cell context='setup'}\n\n```{.r .cell-code}\nlibrary(tidyverse) # or library(lubridate)\n```\n:::\n\n\n\n\n\n\n## 基本用法\n\n### 字符串转日期\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nymd('20221221','2023-12-21','2023/2/21','20/2/21')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-12-21\" \"2023-12-21\" \"2023-02-21\" \"2020-02-21\"\n```\n\n\n:::\n\n```{.r .cell-code}\nmdy('12212022','12212023','12/21/2023','2/21/20')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-12-21\" \"2023-12-21\" \"2023-12-21\" \"2020-02-21\"\n```\n\n\n:::\n:::\n\n\n\n\n\n\n### 时间间隔\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninterval(ymd('2021-12-21'),ymd('20221221'))/years(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1\n```\n\n\n:::\n\n```{.r .cell-code}\ninterval(ymd('2021-12-21'),ymd('20221221'))/months(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4\n```\n\n\n:::\n\n```{.r .cell-code}\ninterval(ymd('2021-12-21'),ymd('20221221'))/weeks(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52.14286\n```\n\n\n:::\n\n```{.r .cell-code}\ninterval(ymd('2021-12-21'),ymd('20221221'))/days(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 365\n```\n\n\n:::\n:::\n\n\n\n\n\n\n### 年月提取\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nymd('2021-12-21') %>% year()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2021\n```\n\n\n:::\n\n```{.r .cell-code}\nymd('2021-12-21') %>% month()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 12\n```\n\n\n:::\n\n```{.r .cell-code}\nymd('2021-12-21') %>% week()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 51\n```\n\n\n:::\n\n```{.r .cell-code}\nymd('2021-12-21') %>% day()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 21\n```\n\n\n:::\n:::\n\n\n\n\n\n\n### 日期运算\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nymd('2021-12-21')+days(365)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-12-21\"\n```\n\n\n:::\n\n```{.r .cell-code}\nymd('2021-12-21')+weeks(52)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-12-20\"\n```\n\n\n:::\n\n```{.r .cell-code}\nymd('2021-12-21')+months(12)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-12-21\"\n```\n\n\n:::\n\n```{.r .cell-code}\nymd('2021-12-21')+years(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-12-21\"\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## 实战应用\n### 年龄计算\n\nHIS系统住院数据模拟，计算就诊年月周，就诊年龄，住院天数\n\n\n\n\n\n\n::: {.cell context='setup'}\n\n```{.r .cell-code}\ndata<-data.frame(id=1:6,birth_date=paste(2021,1,1:6,sep='-'),\n                 admit_date=paste(2023,5:10,6:1,sep='-'),\n                 disch_date=paste(2023,5:10,6:11,sep='-'))\ndata\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  id birth_date admit_date disch_date\n1  1   2021-1-1   2023-5-6   2023-5-6\n2  2   2021-1-2   2023-6-5   2023-6-7\n3  3   2021-1-3   2023-7-4   2023-7-8\n4  4   2021-1-4   2023-8-3   2023-8-9\n5  5   2021-1-5   2023-9-2  2023-9-10\n6  6   2021-1-6  2023-10-1 2023-10-11\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata %>%\n  mutate(birth_date=ymd(birth_date),\n         admit_date=ymd(admit_date),\n         disch_date=ymd(disch_date),\n         age=interval(birth_date,admit_date)/years(1),\n         los=interval(admit_date,disch_date)/days(1)) %>%\n  mutate(year=year(admit_date),\n         month=month(admit_date),\n         week=week(admit_date))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  id birth_date admit_date disch_date      age los year month week\n1  1 2021-01-01 2023-05-06 2023-05-06 2.342466   0 2023     5   18\n2  2 2021-01-02 2023-06-05 2023-06-07 2.421918   2 2023     6   23\n3  3 2021-01-03 2023-07-04 2023-07-08 2.498630   4 2023     7   27\n4  4 2021-01-04 2023-08-03 2023-08-09 2.578082   6 2023     8   31\n5  5 2021-01-05 2023-09-02 2023-09-10 2.657534   8 2023     9   35\n6  6 2021-01-06 2023-10-01 2023-10-11 2.734247  10 2023    10   40\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## 基础包里的日期\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc(\"%Y\", \"%y\", \"%m\", \"%B\", \"%b\", \"%d\", \"%A\", \"%a\", \"%H\", \"%I\", \"%M\", \"%S\", \"%p\", \n  \"%z\", \"%Z\", \"%j\", \"%U\", \"%W\", \"%c\", \"%x\", \"%X\") %>%\n  sapply(function(x){\n    format(Sys.time(),x)\n  }) %>% as.data.frame()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            .\n%Y                       2024\n%y                         24\n%m                         11\n%B                     十一月\n%b                       11月\n%d                         30\n%A                     星期六\n%a                       周六\n%H                         18\n%I                         06\n%M                         53\n%S                         03\n%p                       下午\n%z                      +0800\n%Z                        +08\n%j                        335\n%U                         47\n%W                         48\n%c 周六 11月 30 18:53:03 2024\n%x                 2024/11/30\n%X                   18:53:03\n```\n\n\n:::\n:::",
    "supporting": [
      "clean_date_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}